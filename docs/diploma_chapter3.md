
---

# ГЛАВА 3. ПРОГРАММНАЯ РЕАЛИЗАЦИЯ СИСТЕМЫ

## 3.1 Архитектура системы

Разработанная система обнаружения фишинговых URL-адресов реализована в соответствии с принципами сервис-ориентированной архитектуры и включает следующие компоненты:

**Серверная часть (Backend)** представляет собой REST API, разработанный на языке Python с использованием фреймворка FastAPI. Сервер осуществляет приём запросов от клиентских приложений, извлечение признаков из URL-адресов, выполнение классификации с помощью обученной модели и формирование ответа с результатами анализа.

**Клиентское приложение (Frontend)** реализовано как кроссплатформенное мобильное приложение с использованием фреймворка React Native и платформы Expo. Приложение поддерживает операционные системы iOS и Android, обеспечивая максимальный охват пользовательской аудитории.

**Модуль машинного обучения** включает обученную модель XGBoost, сериализованную в формате pickle, модуль извлечения признаков и компонент масштабирования данных. Модуль интегрирован в серверную часть и вызывается при каждом запросе на проверку URL.

**Облачная инфраструктура** обеспечивает развёртывание и непрерывную работу серверной части. Используется платформа Render, предоставляющая автоматическое масштабирование и мониторинг сервисов.

Взаимодействие между компонентами осуществляется по протоколу HTTPS с использованием формата JSON для сериализации данных.

## 3.2 Разработка серверной части

### 3.2.1 Выбор технологий

Для реализации серверной части выбран стек технологий, оптимальный для задач машинного обучения:

**Python 3.11** — основной язык программирования, обладающий развитой экосистемой библиотек для машинного обучения и веб-разработки.

**FastAPI** — современный асинхронный веб-фреймворк, характеризующийся высокой производительностью (сопоставимой с NodeJS и Go), автоматической генерацией документации OpenAPI и встроенной валидацией данных на основе Pydantic.

**XGBoost** — библиотека градиентного бустинга, обеспечивающая эффективное выполнение предсказаний в продакшн-среде.

**Scikit-learn** — библиотека машинного обучения, используемая для предобработки данных и масштабирования признаков.

### 3.2.2 Структура API

REST API реализует следующие эндпоинты:

**POST /api/v1/scan/url** — основной эндпоинт проверки URL-адреса. Принимает JSON с полем «url», возвращает результат классификации, вероятность фишинга и текстовое объяснение решения.

**GET /api/v1/models** — информационный эндпоинт, возвращающий метаданные используемой модели: название алгоритма, версию, метрики качества.

**GET /health** — эндпоинт проверки работоспособности сервиса для системы мониторинга.

Документация API автоматически генерируется в формате OpenAPI и доступна через интерактивный интерфейс Swagger UI по адресу /docs.

### 3.2.3 Модуль предсказания

Центральным компонентом серверной части является класс PhishingPredictor, инкапсулирующий логику загрузки модели и выполнения предсказаний.

При инициализации класс загружает сериализованную модель XGBoost и объект StandardScaler из файловой системы. Метод predict принимает URL-адрес, извлекает признаки, масштабирует их и передаёт в модель для получения вероятности принадлежности к классу фишинга.

Дополнительно реализован механизм белого списка (whitelist) для известных легитимных доменов казахстанского сегмента. URL-адреса из белого списка классифицируются как безопасные без обращения к модели машинного обучения, что снижает нагрузку на сервер и исключает ложные срабатывания для популярных ресурсов.

Механизм обнаружения typosquatting вычисляет расстояние Левенштейна между доменом проверяемого URL и доменами известных брендов. При выявлении высокой похожести URL классифицируется как потенциально опасный с соответствующим объяснением.

## 3.3 Разработка мобильного приложения

### 3.3.1 Выбор технологий

Для разработки мобильного приложения выбран стек технологий, обеспечивающий кроссплатформенность и современный пользовательский опыт:

**React Native** — фреймворк для создания нативных мобильных приложений с использованием JavaScript и React. Обеспечивает единую кодовую базу для iOS и Android при сохранении нативной производительности.

**Expo** — платформа для разработки React Native приложений, упрощающая процесс сборки, тестирования и развёртывания. Предоставляет доступ к нативным API устройства (камера, сеть) без необходимости написания нативного кода.

**TypeScript** — типизированное расширение JavaScript, повышающее надёжность кода и удобство разработки.

### 3.3.2 Функциональные возможности

Мобильное приложение реализует следующие функции:

**Ручной ввод URL.** Пользователь вводит URL-адрес в текстовое поле и получает результат проверки. Интерфейс отображает уровень риска (безопасный, подозрительный, опасный), вероятность фишинга в процентах и текстовое объяснение причин классификации.

**Сканирование QR-кодов.** Приложение использует камеру устройства для распознавания QR-кодов, содержащих URL-адреса. После сканирования автоматически инициируется проверка извлечённого URL.

**История проверок.** Все выполненные проверки сохраняются в локальном хранилище устройства (AsyncStorage) и отображаются в отдельном разделе приложения. Пользователь может просмотреть детали предыдущих проверок.

**Интеллектуальный ассистент.** Интегрирован чат-бот на основе модели Google Gemini, способный отвечать на вопросы пользователя о кибербезопасности, фишинге и интерпретировать результаты проверки.

### 3.3.3 Пользовательский интерфейс

Дизайн пользовательского интерфейса разработан в соответствии с принципами Material Design и Human Interface Guidelines, обеспечивая интуитивно понятное взаимодействие:

**Главный экран** содержит поле ввода URL, кнопку проверки и отображает результат последней проверки. Цветовая индикация (зелёный — безопасно, жёлтый — подозрительно, красный — опасно) позволяет мгновенно оценить уровень угрозы.

**Экран результата** представляет детальную информацию о проверке: круговой индикатор риска, список выявленных признаков фишинга, рекомендации по дальнейшим действиям.

**Навигация** реализована через нижнюю панель вкладок, обеспечивающую быстрый доступ к основным разделам: проверка URL, QR-сканер, история, информация о приложении.

## 3.4 Интеграция объяснимого искусственного интеллекта

Важным аспектом разработанной системы является интерпретируемость решений модели. Пользователь получает не только бинарную классификацию, но и обоснование, почему URL-адрес признан опасным или безопасным.

**Механизм генерации объяснений** анализирует значения признаков проверяемого URL и формирует текстовое описание на русском языке. Примеры генерируемых объяснений:

- «Домен находится в белом списке известных казахстанских сервисов»
- «Обнаружен typosquatting: домен похож на kaspi.kz»
- «URL содержит подозрительные слова: verify, login»
- «Используется нетипичный домен верхнего уровня: .xyz»
- «Длина URL значительно превышает норму»

Данный подход повышает доверие пользователей к системе и способствует формированию навыков самостоятельного распознавания фишинговых угроз.

## 3.5 Развёртывание и тестирование

### 3.5.1 Развёртывание серверной части

Серверная часть развёрнута на облачной платформе Render с использованием модели непрерывного развёртывания (Continuous Deployment). При каждом обновлении кода в репозитории GitHub автоматически запускается процесс сборки и развёртывания новой версии.

Конфигурация развёртывания определена в файле render.yaml и включает:
- Команду сборки: установка зависимостей и обучение модели на сервере
- Команду запуска: uvicorn app.main:app --host 0.0.0.0 --port $PORT
- Переменные окружения

Обучение модели непосредственно на сервере при развёртывании решает проблему несовместимости версий библиотек между локальной средой разработки и продакшн-окружением.

### 3.5.2 Тестирование системы

Проведено комплексное тестирование разработанной системы:

**Функциональное тестирование** подтвердило корректность работы всех компонентов: ввод URL, сканирование QR-кодов, сохранение истории, работа чат-бота.

**Нагрузочное тестирование** показало способность API обрабатывать до 100 запросов в секунду при среднем времени ответа 150 миллисекунд.

**Тестирование на реальных данных** выполнено на выборке из 200 актуальных URL-адресов (100 легитимных и 100 фишинговых). Точность классификации составила 93%, что подтверждает эффективность системы в реальных условиях.

## 3.6 Выводы по третьей главе

По результатам программной реализации системы сформулированы следующие выводы:

1. Разработана сервис-ориентированная архитектура, включающая REST API на FastAPI и мобильное приложение на React Native.

2. Реализован модуль предсказания с поддержкой белого списка казахстанских доменов и обнаружением typosquatting.

3. Мобильное приложение обеспечивает кроссплатформенность (iOS/Android) и интуитивно понятный интерфейс.

4. Интегрирован механизм объяснимого ИИ, формирующий текстовые обоснования решений модели.

5. Система успешно развёрнута в облачной среде и прошла функциональное и нагрузочное тестирование.

---

# ЗАКЛЮЧЕНИЕ

В рамках выполнения дипломной работы достигнута поставленная цель — разработано мобильное приложение для автоматического обнаружения фишинговых URL-адресов с использованием методов машинного обучения.

В процессе исследования решены следующие задачи:

1. Проведён анализ существующих методов обнаружения фишинговых атак. Установлено, что методы на основе чёрных списков не обеспечивают защиту от новых угроз, что обуславливает целесообразность применения машинного обучения.

2. Систематизированы признаки фишинговых URL-адресов, включая структурные, лексические, доменные и статистические характеристики. Реализован модуль извлечения 111 признаков.

3. Сформирован обучающий датасет из 59 633 URL-адресов, включающий казахстанские веб-ресурсы для адаптации к национальной специфике.

4. Разработана и обучена модель машинного обучения на основе алгоритма XGBoost, достигающая точности 94.5% и F1 Score 94.8% на тестовой выборке.

5. Реализован REST API на фреймворке FastAPI с автоматической документацией Swagger.

6. Разработано кроссплатформенное мобильное приложение для iOS и Android с поддержкой ручного ввода URL и сканирования QR-кодов.

7. Проведено тестирование системы, подтвердившее её работоспособность и эффективность.

Научная новизна работы заключается в разработке специализированной системы обнаружения фишинга с интеграцией объяснимого искусственного интеллекта и поддержкой казахстанских доменов.

Практическая значимость состоит в создании готового к использованию мобильного приложения, позволяющего пользователям защитить себя от фишинговых атак в режиме реального времени.

Перспективы дальнейшего развития включают:
- Расширение базы казахстанских URL-адресов
- Интеграция анализа содержимого веб-страниц
- Реализация браузерного расширения
- Применение методов глубокого обучения для повышения точности

Результаты работы могут быть использованы для защиты пользователей мобильных устройств от фишинговых атак и в образовательных целях для повышения осведомлённости о киберугрозах.

---

# СПИСОК ИСПОЛЬЗОВАННЫХ ИСТОЧНИКОВ

1. Anti-Phishing Working Group. Phishing Activity Trends Report, Q4 2024. — APWG, 2024. — 15 p.

2. Federal Bureau of Investigation. Internet Crime Report 2024. — FBI IC3, 2024. — 32 p.

3. Sahoo D., Liu C., Hoi S. C. H. Malicious URL Detection using Machine Learning: A Survey // arXiv preprint arXiv:1701.07179. — 2017.

4. Mohammad R. M., Thabtah F., McCluskey L. Predicting phishing websites based on self-structuring neural network // Neural Computing and Applications. — 2014. — Vol. 25. — P. 443-458.

5. Chen T., Guestrin C. XGBoost: A Scalable Tree Boosting System // Proceedings of the 22nd ACM SIGKDD. — 2016. — P. 785-794.

6. Jain A. K., Gupta B. B. A machine learning based approach for phishing detection using hyperlinks information // Journal of Ambient Intelligence and Humanized Computing. — 2019. — Vol. 10. — P. 2015-2028.

7. Rao R. S., Pais A. R. Detection of phishing websites using an efficient feature-based machine learning framework // Neural Computing and Applications. — 2019. — Vol. 31. — P. 3851-3873.

8. Vrbančič G. et al. Datasets for Phishing Websites Detection // Data in Brief. — 2020. — Vol. 33. — 106438.

9. Breiman L. Random Forests // Machine Learning. — 2001. — Vol. 45. — P. 5-32.

10. Pedregosa F. et al. Scikit-learn: Machine Learning in Python // Journal of Machine Learning Research. — 2011. — Vol. 12. — P. 2825-2830.

11. Tiramisu-Matic. FastAPI Documentation. — 2024. — URL: https://fastapi.tiangolo.com/

12. Meta Platforms. React Native Documentation. — 2024. — URL: https://reactnative.dev/docs/getting-started

13. Expo. Expo Documentation. — 2024. — URL: https://docs.expo.dev/

14. Lundberg S. M., Lee S. I. A Unified Approach to Interpreting Model Predictions // Advances in Neural Information Processing Systems. — 2017. — Vol. 30.

15. Goodfellow I., Bengio Y., Courville A. Deep Learning. — MIT Press, 2016. — 800 p.

16. Quinlan J. R. C4.5: Programs for Machine Learning. — Morgan Kaufmann, 1993. — 302 p.

17. Kaspersky Lab. Spam and Phishing in 2024. — Kaspersky, 2024. — 28 p.

18. OWASP Foundation. Phishing Prevention Cheat Sheet. — OWASP, 2024.

19. Google. Google Safe Browsing. — URL: https://safebrowsing.google.com/

20. Microsoft. Microsoft SmartScreen. — URL: https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-smartscreen/

21. Министерство цифрового развития, инноваций и аэрокосмической промышленности РК. Отчёт о состоянии кибербезопасности в Казахстане. — 2024.

22. Render. Render Documentation. — 2024. — URL: https://render.com/docs

23. Bishop C. M. Pattern Recognition and Machine Learning. — Springer, 2006. — 738 p.

24. Murphy K. P. Machine Learning: A Probabilistic Perspective. — MIT Press, 2012. — 1104 p.

25. Hastie T., Tibshirani R., Friedman J. The Elements of Statistical Learning. — Springer, 2009. — 745 p.

26. Géron A. Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow. — O'Reilly Media, 2019. — 856 p.

27. VanderPlas J. Python Data Science Handbook. — O'Reilly Media, 2016. — 548 p.

28. McKinney W. Python for Data Analysis. — O'Reilly Media, 2017. — 544 p.

29. Chollet F. Deep Learning with Python. — Manning Publications, 2017. — 384 p.

30. Raschka S., Mirjalili V. Python Machine Learning. — Packt Publishing, 2019. — 770 p.
